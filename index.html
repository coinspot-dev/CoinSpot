<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoinSpot | Believe Ecosystem Tracker</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; /* Light track */
        }
        ::-webkit-scrollbar-thumb {
            background: #10b981; /* Emerald 500 - Believe Green */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #059669;
        }

        /* Styling for the animated trade feed */
        .trade-item {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ANIMATION: Card Hover Effect (Custom Class) */
        .card-animate {
            transition: all 0.3s ease;
        }
        /* Hover hanya untuk elemen yang bukan tombol */
        .card-animate:not(button):hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.2), 0 4px 6px -2px rgba(16, 185, 129, 0.05); /* Green Shadow */
        }

        /* Custom Modal Styling */
        .modal {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        /* FIX: Ensure horizontal scroll is available for tables if needed, but primary focus is hiding non-essential columns */
        .overflow-x-auto {
            -webkit-overflow-scrolling: touch;
        }

        /* Custom style for active tab */
        .active-tab {
            border-bottom-width: 2px;
        }

        /* Custom Class: Menjamin Ikon Mengisi Lingkaran Penuh */
        .full-circle-container {
            background-color: #10b981; /* Solid Emerald Background */
            border-radius: 9999px; /* rounded-full */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0; /* Penting untuk ponsel */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen">

    <!-- MODAL POPUP -->
    <div id="buy-modal" class="modal fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 opacity-0 pointer-events-none">
        <div class="bg-white p-8 rounded-xl shadow-2xl max-w-lg w-full transform -translate-y-5 transition-transform duration-300">
            <h3 class="text-2xl font-bold text-gray-900 mb-4">Confirm Purchase</h3>
            <p class="text-gray-700 mb-6">You are attempting to perform a trade action for <span id="modal-coin-name" class="font-bold text-emerald-600"></span>. </p>
            <p class="text-sm text-gray-500 mb-6">In a live application, clicking this button would typically redirect you to the Believe App's trading interface to execute the buy order.</p>
            
            <div class="flex justify-end space-x-4">
                <button onclick="closeModal()" class="px-6 py-2 bg-gray-200 text-gray-800 font-medium rounded-lg hover:bg-gray-300 transition duration-150">Close</button>
                <button onclick="handleBuyRedirect()" class="px-6 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition duration-150 shadow-md">Go to Trading</button>
            </div>
        </div>
    </div>

    <!-- Header & Navigation -->
    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                
                <!-- Logo and Title -->
                <a href="#" class="flex items-center space-x-2">
                    <!-- LOGO COINSPOT - DIJAMIN BULAT DAN PRESISI -->
                    <div class="full-circle-container w-9 h-9">
                        <img src="./assets/coinspot-icon.png" 
                             onerror="this.src='https://placehold.co/36x36/10b981/ffffff?text=CS&font=sans-serif';" 
                             alt="CoinSpot Logo" 
                             class="w-full h-full object-cover"/>
                    </div>
                    <span class="text-2xl font-extrabold text-gray-900">CoinSpot</span>
                </a>

                <!-- Tabs/Navigation (Dioptimalkan untuk mobile) -->
                <nav class="flex space-x-1 sm:space-x-4">
                    <button class="nav-tab text-xs sm:text-base font-medium text-gray-500 hover:text-emerald-600 px-1 sm:px-3 py-2 border-b-2 border-transparent transition duration-150 ease-in-out active-tab" data-tab="dashboard">Dashboard</button>
                    <button class="nav-tab text-xs sm:text-base font-medium text-gray-500 hover:text-emerald-600 px-1 sm:px-3 py-2 border-b-2 border-transparent transition duration-150 ease-in-out" data-tab="new-coins">New Coins</button>
                    <button class="nav-tab text-xs sm:text-base font-medium text-gray-500 hover:text-emerald-600 px-1 sm:px-3 py-2 border-b-2 border-transparent transition duration-150 ease-in-out" data-tab="last-trades">Last Trades</button>
                </nav>

                <!-- Action Button Placeholder -->
                <div class="hidden sm:inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg">
                    <!-- Placeholder untuk menjaga keseimbangan layout -->
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-gray-900 bg-gradient-to-br from-emerald-50 to-green-100 rounded-xl shadow-inner">

        <!-- Dashboard Tab Content -->
        <div id="dashboard" class="tab-content">
            
            <!-- JUDUL DENGAN LOGO BELIEVE -->
            <div class="flex items-center space-x-3 mb-6">
                <h1 class="text-2xl sm:text-3xl font-bold">Believe Ecosystem Dashboard</h1>
                <!-- LOGO BELIEVE - DIJAMIN BULAT PENUH -->
                <a href="https://believe.app/" target="_blank" aria-label="Go to Believe App website" class="hover:opacity-80 transition duration-150">
                    <div class="full-circle-container w-8 h-8">
                        <img src="./assets/believe-logo.png" 
                            onerror="this.src='https://placehold.co/32x32/10b981/ffffff?text=B&font=sans-serif';" 
                            alt="Believe Logo" 
                            class="w-full h-full object-cover"/>
                    </div>
                </a>
                <!-- Menghapus logo B tekstual untuk menjaga kerapihan -->
            </div>
            
            <!-- Market Snapshot Cards (Diubah menjadi rounded-3xl agar tidak memotong konten) -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 mb-10">
                
                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 card-animate">
                    <p class="text-xs sm:text-sm font-medium text-gray-500">Ecosystem Market Cap</p>
                    <p id="market-cap" class="text-xl sm:text-3xl font-bold text-gray-900 mt-1">$0</p>
                    <p id="market-cap-change" class="text-xs text-green-600 mt-2 flex items-center">
                        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                        +0.0% (24H)
                    </p>
                </div>

                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 card-animate">
                    <p class="text-xs sm:text-sm font-medium text-gray-500">24H Volume</p>
                    <p id="volume" class="text-xl sm:text-3xl font-bold text-gray-900 mt-1">$0</p>
                    <p class="text-xs text-green-600 mt-2 flex items-center">
                        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
                        +0.0% (24H)
                    </p>
                </div>

                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 card-animate">
                    <p class="text-xs sm:text-sm font-medium text-gray-500">Total Coins Launched</p>
                    <p id="total-coins" class="text-xl sm:text-3xl font-bold text-gray-900 mt-1">—</p>
                    <p class="text-xs text-gray-500 mt-2">
                        + Today
                    </p>
                </div>

                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 card-animate">
                    <p class="text-xs sm:text-sm font-medium text-gray-500">BELIEVE Price</p>
                    <p id="launchcoin-price" class="text-xl sm:text-3xl font-bold text-gray-900 mt-1">$0.0000</p>
                    <p id="launchcoin-change" class="text-xs text-red-600 mt-2 flex items-center">
                        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 112 0v7.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                        0.0% (24H)
                    </p>
                </div>
            </div>

            <!-- Trending Coins Table (Dioptimalkan: kolom Volume & Cap disembunyikan di mobile) -->
            <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-10">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl sm:text-2xl font-bold">Trending Coins (24H)</h2>
                    <div class="flex gap-2">
                        <button id="btnSortChange" type="button" class="px-3 py-1.5 text-xs bg-emerald-600 text-white rounded-full hover:bg-emerald-700">Sort by Change</button>
                        <button id="btnSortVol" type="button" class="px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200">Sort by Volume</button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead>
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">#</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Coin</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Price</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">24H Change</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase hidden md:table-cell">24H Volume</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase hidden sm:table-cell">Market Cap</th>
                                <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Action</th>
                            </tr>
                        </thead>
                        <tbody id="trending-coins-body" class="bg-white divide-y divide-gray-200">
                            <tr class="text-center"><td colspan="7" class="py-4 text-gray-500">Loading data...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Last Trades Preview (Mobile/Condensed) -->
            <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 md:hidden">
                <h2 class="text-xl sm:text-2xl font-bold mb-4">Recent Trades</h2>
                <div id="last-trades-mobile" class="h-64 overflow-y-auto">
                    <p class="text-gray-400 text-center py-10">Loading real-time trade data...</p>
                </div>
            </div>
        </div>

        <!-- New Coins Tab Content (Dioptimalkan: kolom Volume & Cap disembunyikan di mobile) -->
        <div id="new-coins" class="tab-content hidden">
            <h1 class="text-2xl sm:text-3xl font-bold mb-2">New Coin Launches</h1>
            <p class="text-gray-600 mb-6">Newest tokens minted on the Believe platform.</p>
            <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6">
                <h2 class="text-xl font-semibold mb-4">Latest Launches (Last 7 Days)</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead>
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Token</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Price</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase hidden md:table-cell">24H Volume</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase hidden sm:table-cell">Market Cap</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Launch</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <!-- Data simulasi di sini (dipertahankan agar tampilan New Coins tidak kosong) -->
                            <tr class="hover:bg-gray-50 transition card-animate">
                                <td class="px-6 py-4 text-sm font-medium">AlphaGen</td>
                                <td class="px-6 py-4 text-sm text-green-600 text-right font-semibold">$0.00035</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden md:table-cell">$185K</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden sm:table-cell">$450K</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500">10 mins ago</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition card-animate">
                                <td class="px-6 py-4 text-sm font-medium">SolStack</td>
                                <td class="px-6 py-4 text-sm text-red-600 text-right font-semibold">$0.0049</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden md:table-cell">$92K</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden sm:table-cell">$850K</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500">2 hours ago</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition card-animate">
                                <td class="px-6 py-4 text-sm font-medium">MemeBlast</td>
                                <td class="px-6 py-4 text-sm text-green-600 text-right font-semibold">$0.000015</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden md:table-cell">$210K</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500 hidden sm:table-cell">$3.1M</td>
                                <td class="px-6 py-4 text-sm text-right text-gray-500">1 day ago</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Last Trades Tab Content -->
        <div id="last-trades" class="tab-content hidden">
            <h1 class="text-2xl sm:text-3xl font-bold mb-6">Real-Time Trades Feed</h1>
            <p class="text-gray-600 mb-6">Live stream of buy/sell transactions across the Believe ecosystem.</p>
            <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6">
                <!-- Desktop View -->
                <div id="last-trades-body-desktop" class="hidden md:block h-[70vh] overflow-y-auto">
                    <!-- Data will be inserted here by JavaScript -->
                    <p class="text-gray-400 text-center py-10">Loading real-time trade data...</p>
                </div>
                <!-- Mobile View -->
                <div id="last-trades-body-mobile" class="md:hidden h-[70vh] overflow-y-auto">
                    <!-- Data will be inserted here by JavaScript -->
                    <p class="text-gray-400 text-center py-10">Loading real-time trade data...</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 mt-10">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
                <!-- Link X/Twitter yang Benar -->
                <a href="https://x.com/CoinSpotBLV" target="_blank" class="text-gray-400 hover:text-emerald-400" aria-label="CoinSpot on X">
                    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M18.9 1.15h3.68l-8.04 9.18L24 22.85h-7.61l-6.2-7.02L4.76 1.15H1.08l8.4 9.62L0 22.85h8.04l5.52-6.31L18.9 1.15zM16.87 2.99h-.48L7.22 21.05h.48L16.87 3z"/></svg>
                </a>
                <p class="text-sm text-gray-400">© 2025 CoinSpot by Believe App. All rights reserved.</p>
            </div>
            <p class="mt-2 text-xs text-gray-500">Disclaimer: Data is simulated for demonstration. Crypto trading is high risk.</p>
        </div>
    </footer>

    <script>
        // Modal functions
        function openModal(name) {
            const modal = document.getElementById('buy-modal');
            document.getElementById('modal-coin-name').textContent = name;
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.querySelector('div').classList.remove('-translate-y-4');
        }
        function closeModal() {
            const modal = document.getElementById('buy-modal');
            modal.classList.add('opacity-0', 'pointer-events-none');
            modal.querySelector('div').classList.add('-translate-y-4');
        }
        function handleBuyRedirect() {
            console.log('Deep-link trading for', document.getElementById('modal-coin-name').textContent);
            closeModal();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const trendingBody = document.getElementById('trending-coins-body');
            const lastTradesBodyDesktop = document.getElementById('last-trades-body-desktop');
            const lastTradesBodyMobile = document.getElementById('last-trades-body-mobile');
            const navTabs = document.querySelectorAll('.nav-tab');
            const tabContents = document.querySelectorAll('.tab-content');

            // --- Fallback Data ---
            const FALLBACK_COINS = [
                { name: 'Social Fi', symbol: 'BEL', price: 0.154, change: 154, volume: 1200000, cap: 5300000 },
                { name: 'LaunchPad Meme', symbol: 'LPM', price: 0.00019, change: 78, volume: 850000, cap: 1900000 },
                { name: 'Solana Pump', symbol: 'SLP', price: 0.00115, change: -12, volume: 600000, cap: 4100000 },
                { name: 'Creator Fund', symbol: 'CRF', price: 0.0089, change: 45, volume: 450000, cap: 3200000 },
                { name: 'Tweet Token', symbol: 'TWT', price: 0.051, change: 8, volume: 300000, cap: 2500000 },
                { name: 'Meteora Link', symbol: 'MTL', price: 0.78, change: -2.5, volume: 210000, cap: 1800000 },
                { name: 'Community Vibe', symbol: 'CVB', price: 0.0003, change: 10.5, volume: 150000, cap: 900000 },
            ];
            let CURRENT_COINS = [...FALLBACK_COINS];
            let tradeQueue = []; const MAX_TRADES = 50;

            const fmtN = (n) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 4 }).format(n);
            const fmtC = (n) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 6 }).format(n);
            const fmtCompact = (n) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', notation: 'compact', minimumFractionDigits: 0, maximumFractionDigits: 2 }).format(n);

            // --- Rendering Functions ---

            // Function to handle active button styling
            const btnSortChange = document.getElementById('btnSortChange');
            const btnSortVol = document.getElementById('btnSortVol');

            function setActiveSortButton(activeButtonId) {
                const activeClasses = ['bg-emerald-600', 'text-white', 'hover:bg-emerald-700'];
                const inactiveClasses = ['bg-gray-100', 'text-gray-700', 'hover:bg-gray-200'];

                [btnSortChange, btnSortVol].forEach(btn => {
                    if (btn.id === activeButtonId) {
                        btn.classList.add(...activeClasses);
                        btn.classList.remove(...inactiveClasses);
                    } else {
                        btn.classList.remove(...activeClasses);
                        btn.classList.add(...inactiveClasses);
                    }
                });
            }


            function renderTrending(coins) {
                // Initial sorting is by change (default) - no sort call here, just render based on current array order
                
                if (!coins.length) {
                    trendingBody.innerHTML = '<tr><td colspan="7" class="py-8 text-center text-gray-500">No data</td></tr>';
                    return;
                }

                // Table Rows
                trendingBody.innerHTML = coins.map((c, i) => {
                    const color = c.change >= 0 ? 'text-green-600' : 'text-red-600';
                    const sign = c.change >= 0 ? '+' : '';
                    
                    return `<tr class="hover:bg-gray-50 transition">
                        <td class="px-6 py-4 text-sm">${i + 1}</td>
                        <td class="px-6 py-4 text-sm font-medium text-emerald-600">${c.name} <span class="text-xs text-gray-400">(${c.symbol})</span></td>
                        <td class="px-6 py-4 text-sm text-right">${fmtC(c.price)}</td>
                        <td class="px-6 py-4 text-sm text-right ${color} font-semibold">${sign}${fmtN(c.change)}%</td>
                        <td class="px-6 py-4 text-sm text-right text-gray-600 hidden md:table-cell">${fmtCompact(c.volume)}</td>
                        <td class="px-6 py-4 text-sm text-right text-gray-600 hidden sm:table-cell">${fmtCompact(c.cap)}</td>
                        <td class="px-6 py-4 text-center">
                            <button type="button" class="px-3 py-1 text-xs bg-emerald-600 text-white rounded-full hover:bg-emerald-700 transition" onclick="openModal('${c.name}')">BELIEVE</button>
                        </td>
                    </tr>`;
                }).join('');

                // Update Market Snapshot
                const cap = coins.reduce((s, c) => s + c.cap, 0);
                const vol = coins.reduce((s, c) => s + c.volume, 0);
                document.getElementById('market-cap').textContent = fmtCompact(cap);
                document.getElementById('volume').textContent = fmtCompact(vol);
                document.getElementById('total-coins').textContent = (coins.length * 357).toLocaleString();
                
                const bel = coins.find(c => c.symbol === 'BEL');
                if (bel) {
                    document.getElementById('launchcoin-price').textContent = fmtC(bel.price);
                    const changeEl = document.getElementById('launchcoin-change');
                    changeEl.textContent = `${bel.change >= 0 ? '+' : ''}${fmtN(bel.change)}% (24H)`;
                    changeEl.className = `text-xs ${bel.change >= 0 ? 'text-green-600' : 'text-red-600'} mt-2 flex items-center`;
                }
            }

            function generateTradeFallback() {
                const c = CURRENT_COINS[Math.floor(Math.random() * CURRENT_COINS.length)];
                const type = Math.random() > 0.5 ? 'Buy' : 'Sell';
                const usd = Math.floor(Math.random() * 5000) + 10;
                const tokens = usd / (c.price || 0.01);
                const tx = '0x' + (Math.random() * 0xFFFFFFFFFFFFF).toString(16).slice(0, 10) + '...';
                return { coinSymbol: c.symbol, type, tokenAmount: tokens, amountUSD: usd, time: 'Just now', tx };
            }

            function renderTrades() {
                if (!tradeQueue.length) {
                    lastTradesBodyDesktop.innerHTML = '<p class="text-gray-400 text-center py-10">No recent trades.</p>';
                    lastTradesBodyMobile.innerHTML = '<p class="text-gray-400 text-center py-10">No recent trades.</p>';
                    return;
                }

                // Desktop View (Full grid-cols-6)
                let desktopHtml = `<div class="grid grid-cols-6 gap-4 p-3 font-semibold text-gray-700 border-b border-gray-200">
                    <div class="text-sm">Time</div><div class="text-sm">Coin</div><div class="text-sm text-center">Type</div>
                    <div class="text-sm text-right">Token Amount</div><div class="text-sm text-right">USD Amount</div><div class="text-sm text-right">Tx Hash</div></div>`;
                
                // Mobile View (Condensed)
                let mobileHtml = '';

                tradeQueue.forEach(t => {
                    const tag = t.type === 'Buy' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700';
                    
                    // Desktop row
                    desktopHtml += `<div class="trade-item grid grid-cols-6 gap-4 p-3 hover:bg-gray-50 border-b border-gray-100">
                        <div class="text-sm text-gray-500">${t.time}</div>
                        <div class="text-sm font-semibold">${t.coinSymbol}</div>
                        <div class="text-center"><span class="px-3 py-1 rounded-full text-xs ${tag}">${t.type}</span></div>
                        <div class="text-right text-sm">${fmtN(t.tokenAmount)}</div>
                        <div class="text-right text-sm font-bold">${fmtC(t.amountUSD)}</div>
                        <div class="text-right text-sm text-emerald-600 truncate"><a href="#" title="Explorer">${t.tx}</a></div>
                    </div>`;

                    // Mobile condensed item
                    mobileHtml += `<div class="trade-item p-3 border-b border-gray-100 flex justify-between items-center">
                        <div>
                            <span class="font-semibold text-gray-900">${t.coinSymbol}</span>
                            <span class="ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${tag}">${t.type}</span>
                            <p class="text-xs text-gray-500 mt-1">Amt: ${fmtN(t.tokenAmount)}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-sm">${fmtC(t.amountUSD)}</p>
                            <p class="text-xs text-gray-400">${t.time}</p>
                        </div>
                    </div>`;
                });

                lastTradesBodyDesktop.innerHTML = desktopHtml;
                lastTradesBodyMobile.innerHTML = mobileHtml;
            }

            // --- Initialization ---
            
            // Sort the array initially by change
            CURRENT_COINS.sort((a, b) => Math.abs(b.change) - Math.abs(a.change));

            renderTrending(CURRENT_COINS);
            setActiveSortButton('btnSortChange'); // Set Change as active by default

            // Initial trade render and interval setup
            tradeQueue.unshift(generateTradeFallback()); 
            tradeQueue = tradeQueue.slice(0, MAX_TRADES); 
            renderTrades();
            // Start real-time simulation interval
            setInterval(() => {
                tradeQueue.unshift(generateTradeFallback()); 
                tradeQueue = tradeQueue.slice(0, MAX_TRADES); 
                renderTrades();
            }, 3000);

            // --- Sorting and Tab Listeners ---

            document.getElementById('btnSortChange').addEventListener('click', () => { 
                CURRENT_COINS.sort((a, b) => Math.abs(b.change) - Math.abs(a.change)); 
                renderTrending(CURRENT_COINS);
                setActiveSortButton('btnSortChange'); // ADDED: Set visual state
            });

            document.getElementById('btnSortVol').addEventListener('click', () => { 
                CURRENT_COINS.sort((a, b) => b.volume - a.volume); 
                renderTrending(CURRENT_COINS);
                setActiveSortButton('btnSortVol'); // ADDED: Set visual state
            });

            navTabs.forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.tab;
                    // Remove active classes from all tabs
                    navTabs.forEach(b => b.classList.remove('border-emerald-600', 'text-emerald-600', 'active-tab'));
                    navTabs.forEach(b => b.classList.add('border-transparent', 'text-gray-500'));
                    
                    // Add active classes to the clicked tab
                    btn.classList.add('border-emerald-600', 'text-emerald-600', 'active-tab');
                    
                    // Show/hide content sections
                    document.querySelectorAll('.tab-content').forEach(sec => sec.classList.toggle('hidden', sec.id !== id));
                });
            });

            document.querySelector('.active-tab').classList.add('border-emerald-600', 'text-emerald-600');
        });
    </script>
</body>
</html>
